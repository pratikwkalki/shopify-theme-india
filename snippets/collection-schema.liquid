{% assign productCount = 0 %}
{% assign totalProductsInCollection  = collection.products_count %}
{%- paginate collection.products by 50 -%}
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "ItemList",
    "itemListElement": [
      {% for product in collection.products %}
      {
      "@type": "ListItem",
      "position": {{ forloop.index }},
      "name": "{{ product.title | escape }}",
      "url": "{{ product.url | within: collection }}"
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]
  }
</script> 
{% endpaginate %}